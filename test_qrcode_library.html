<!DOCTYPE html>
<html>
<head>
    <title>Test QRCode Library Loading</title>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <script>
        // Fallback CDN
        if (typeof QRCode === 'undefined') {
            console.log('Primary CDN failed, trying fallback...');
            var script = document.createElement('script');
            script.src = 'https://unpkg.com/qrcode@1.5.3/build/qrcode.min.js';
            script.onload = function() {
                console.log('Fallback CDN loaded successfully');
                testQRGeneration();
            };
            script.onerror = function() {
                console.error('Both CDN failed');
                document.getElementById('status').textContent = 'FAILED: Both CDN failed';
            };
            document.head.appendChild(script);
        } else {
            document.addEventListener('DOMContentLoaded', testQRGeneration);
        }

        function testQRGeneration() {
            const status = document.getElementById('status');
            
            if (typeof QRCode === 'undefined') {
                status.textContent = 'FAILED: QRCode library not available';
                status.style.color = 'red';
                return;
            }

            status.textContent = 'SUCCESS: QRCode library loaded';
            status.style.color = 'green';

            // Test QR generation
            const canvas = document.getElementById('test-canvas');
            const testText = 'GOBOOTH PAYMENT\nOrder: TEST-123\nAmount: Rp 15.000';

            QRCode.toCanvas(canvas, testText, {
                width: 200,
                height: 200,
                margin: 2
            }, function (error) {
                const result = document.getElementById('result');
                if (error) {
                    result.textContent = 'FAILED: ' + error.message;
                    result.style.color = 'red';
                } else {
                    result.textContent = 'SUCCESS: QR Code generated';
                    result.style.color = 'green';
                }
            });
        }
    </script>
</head>
<body>
    <h1>QRCode Library Test</h1>
    <p id="status">Loading...</p>
    <p id="result">Waiting...</p>
    <canvas id="test-canvas"></canvas>
</body>
</html>
